<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Testing your cluster | Example Guide | SUSE Linux Enterprise High Performance Computing 15 SP2</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><link rel="stylesheet" type="text/css" href="static/css/brand.css" /><meta name="generator" content="DAPS 3.0.0 (https://opensuse.github.io/daps) using openSUSE XSL Stylesheets 2.0.13 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise High Performance Computing" /><meta name="product-number" content="15 SP2" /><meta name="book-title" content="Example Guide" /><meta name="chapter-title" content="Chapter 8. Testing your cluster" /><meta name="description" content="What is this chapter about?" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="assignee@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="High Performance Computing" /><link rel="home" href="index.html" title="Example Guide" /><link rel="up" href="part-testing.html" title="Part VIII. Testing" /><link rel="prev" href="part-testing.html" title="Part VIII. Testing" /><link rel="next" href="app-example-doc-update.html" title="Appendix A. Documentation Updates" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #FABEBE;"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Example Guide"><span class="book-icon">Example Guide</span></a><span> › </span><a class="crumb" href="part-testing.html">Testing</a><span> › </span><a class="crumb" href="cha-testing.html">Testing your cluster</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Example Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-example.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part-intro.html"><span class="number">I </span><span class="name">Introduction</span></a><ol><li class="inactive"><a href="cha-introduction.html"><span class="number">1 </span><span class="name">SUSE Linux Enterprise High Performance Computing 15 SP2</span></a></li></ol></li><li class="inactive"><a href="part-inst.html"><span class="number">II </span><span class="name">Installation</span></a><ol><li class="inactive"><a href="installation.html"><span class="number">2 </span><span class="name">Installation and Upgrade</span></a></li></ol></li><li class="inactive"><a href="part-remote.html"><span class="number">III </span><span class="name">Remote Administration</span></a><ol><li class="inactive"><a href="cha-remote.html"><span class="number">3 </span><span class="name">Remote Administration</span></a></li></ol></li><li class="inactive"><a href="part-nodes.html"><span class="number">IV </span><span class="name">Nodes</span></a><ol><li class="inactive"><a href="cha-nodes.html"><span class="number">4 </span><span class="name">Nodes</span></a></li></ol></li><li class="inactive"><a href="part-sched.html"><span class="number">V </span><span class="name">Scheduler</span></a><ol><li class="inactive"><a href="cha-scheduler.html"><span class="number">5 </span><span class="name">Scheduler</span></a></li></ol></li><li class="inactive"><a href="part-monitoring.html"><span class="number">VI </span><span class="name">Monitoring</span></a><ol><li class="inactive"><a href="cha-monitoring.html"><span class="number">6 </span><span class="name">Monitoring</span></a></li></ol></li><li class="inactive"><a href="part-compute.html"><span class="number">VII </span><span class="name">Compute</span></a><ol><li class="inactive"><a href="cha-compute.html"><span class="number">7 </span><span class="name">Compute</span></a></li></ol></li><li class="inactive"><a href="part-testing.html"><span class="number">VIII </span><span class="name">Testing</span></a><ol><li class="inactive"><a href="cha-testing.html"><span class="number">8 </span><span class="name">Testing your cluster</span></a></li></ol></li><li class="inactive"><a href="app-example-doc-update.html"><span class="number">A </span><span class="name">Documentation Updates</span></a></li><li class="inactive"><a href="apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part VIII. Testing" href="part-testing.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Appendix A. Documentation Updates" href="app-example-doc-update.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #FABEBE;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Example Guide"><span class="book-icon">Example Guide</span></a><span> › </span><a class="crumb" href="part-testing.html">Testing</a><span> › </span><a class="crumb" href="cha-testing.html">Testing your cluster</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part VIII. Testing" href="part-testing.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Appendix A. Documentation Updates" href="app-example-doc-update.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div xml:lang="en" class="chapter " id="cha-testing" lang="en"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Linux Enterprise High Performance Computing</span> <span class="productnumber">15 SP2</span></div><div><h2 class="title"><span class="number">8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Testing your cluster</span> </h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>testing.xml</li><li><span class="ds-label">ID: </span>cha-testing</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha-testing.html#id-1.10.2.2.1">#</a></h6></div><p>
    What is this chapter about?
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-testing.html#sec-testing-slurm"><span class="number">8.1 </span><span class="name">slurm</span></a></span></dt><dt><span class="sect1"><a href="cha-testing.html#sec-testing-mpi"><span class="number">8.2 </span><span class="name">How to quickly test MPI</span></a></span></dt><dt><span class="sect1"><a href="cha-testing.html#sec-testing-install"><span class="number">8.3 </span><span class="name">Installation</span></a></span></dt><dt><span class="sect1"><a href="cha-testing.html#sec-testing-buildmpi"><span class="number">8.4 </span><span class="name">Build MPI test</span></a></span></dt><dt><span class="sect1"><a href="cha-testing.html#sec-testing-nfsserver"><span class="number">8.5 </span><span class="name">Setup the NFS server</span></a></span></dt></dl></div></div><div class="sect1 " id="sec-testing-slurm"><div class="titlepage"><div><div><h2 class="title" id="sec-testing-slurm"><span class="number">8.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">slurm</span> <a title="Permalink" class="permalink" href="cha-testing.html#sec-testing-slurm">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>testing.xml</li><li><span class="ds-label">ID: </span>sec-testing-slurm</li></ul></div></div></div></div><div class="verbatim-wrap"><pre class="screen">#!/usr/bin/env bash
#Job name
#SBATCH -J TEST_Slurm
# Asking for one node
#SBATCH -N 1
# Output results message
#SBATCH -o slurm-%j.out
# Output error message
#SBATCH -e slurm-%j.err
module purge
echo '=====my job informations ==== '
echo 'Node List: ' $SLURM_NODELIST
echo 'my jobID: ' $SLURM_JOB_ID
echo 'Partition: ' $SLURM_JOB_PARTITION
echo 'submit directory:' $SLURM_SUBMIT_DIR
echo 'submit host:' $SLURM_SUBMIT_HOST
echo 'In the directory: `pwd`'
echo 'As the user: `whoami`'</pre></div><div class="verbatim-wrap"><pre class="screen">#!/usr/bin/env bash
#Job name
#S -J plop
# Asking for one node
#S -N 8
module load gnu
module load openmpi
mpirun -n 8 /export/mpi_hello_world</pre></div><div class="verbatim-wrap"><pre class="screen">sbatch -n 8 run_mpi_test.sh</pre></div></div><div class="sect1 " id="sec-testing-mpi"><div class="titlepage"><div><div><h2 class="title" id="sec-testing-mpi"><span class="number">8.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">How to quickly test MPI</span> <a title="Permalink" class="permalink" href="cha-testing.html#sec-testing-mpi">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>testing.xml</li><li><span class="ds-label">ID: </span>sec-testing-mpi</li></ul></div></div></div></div><p>
   This section describes how to quickly test MPI on your cluster.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Install all needed components</p></li><li class="step "><p>Create an NFS export directory for the <code class="literal">mpiuser</code>
    to get access from all nodes to a share dir (<code class="literal">/export</code>)</p></li><li class="step "><p>create the <code class="literal">mpiuser</code></p></li><li class="step "><p>build a mpi test code</p></li><li class="step "><p>test the mpi code over all nodes</p></li></ol></div></div></div><div class="sect1 " id="sec-testing-install"><div class="titlepage"><div><div><h2 class="title" id="sec-testing-install"><span class="number">8.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Installation</span> <a title="Permalink" class="permalink" href="cha-testing.html#sec-testing-install">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>testing.xml</li><li><span class="ds-label">ID: </span>sec-testing-install</li></ul></div></div></div></div><p>
   To be able to test MPI on your cluster you need to install different component
   to get the expected services.
  </p><p>
   All nodes needs to access the NFS server, so on all nodes install
   <code class="literal">nfs-utils</code> and enable the service:
  </p><div class="verbatim-wrap"><pre class="screen">zypper in -y nfs-utils
systemctl enable nfs
systemctl start nfs</pre></div><p>
   You should install if this is not yet done needed libraries:
  </p><div class="verbatim-wrap"><pre class="screen">zypper in -y patterns-hpc-compute_node patterns-hpc-libraries</pre></div></div><div class="sect1 " id="sec-testing-buildmpi"><div class="titlepage"><div><div><h2 class="title" id="sec-testing-buildmpi"><span class="number">8.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Build MPI test</span> <a title="Permalink" class="permalink" href="cha-testing.html#sec-testing-buildmpi">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>testing.xml</li><li><span class="ds-label">ID: </span>sec-testing-buildmpi</li></ul></div></div></div></div><div class="verbatim-wrap"><pre class="screen">module load gnu &amp;&amp; module load openmpi &amp;&amp; mpirun --hostfile /etc/nodes -n 8 /export/mpi_hello_world</pre></div></div><div class="sect1 " id="sec-testing-nfsserver"><div class="titlepage"><div><div><h2 class="title" id="sec-testing-nfsserver"><span class="number">8.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Setup the NFS server</span> <a title="Permalink" class="permalink" href="cha-testing.html#sec-testing-nfsserver">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>testing.xml</li><li><span class="ds-label">ID: </span>sec-testing-nfsserver</li></ul></div></div></div></div><div class="verbatim-wrap"><pre class="screen">mkdir /export
echo '/export    *(rw,root_squash,sync,no_subtree_check)' &gt; /etc/exports
systemctl enable nfs-server.service
systemctl restart nfs-server.service
exportfs</pre></div><div class="verbatim-wrap"><pre class="screen">useradd -d /export -g users -G slurm -M -p \"PASSWORD\" -u 666 mpitest</pre></div><div class="verbatim-wrap"><pre class="screen">mkdir -p /export/.ssh
${NODENAME}1:/export/.ssh/authorized_keys
chown mpitest.users -R /export/
ssh-keygen -t rsa -f ~/.ssh/id_rsa -N ''
cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
cat &gt; ~/.ssh/config</pre></div><div class="verbatim-wrap"><pre class="screen">mount ${NODENAME}1:/export /export</pre></div><div class="verbatim-wrap"><pre class="screen">#!/bin/sh
module load gnu
module load openmpi
mpicc -o mpi_hello_world mpi_hello_world.c</pre></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="app-example-doc-update.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Appendix A </span>Documentation Updates</span></a><a class="nav-link" href="part-testing.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part VIII </span>Testing</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2020 
        SUSE</p></div></div></body></html>